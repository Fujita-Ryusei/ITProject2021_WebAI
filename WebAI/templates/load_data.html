{% extends "index.html" %}
{% block content %}
<body>

    <div id="wrap">
    
    <script>
        function displayRadio(){
        {% for key, value in columns_nulldata.items() %}
            
            
            if('{{value[1]}}' == 'object'){
                document.write('<option value="{{ key }}">' + '{{ key }}:{{ value[0] }}' + '</option>' +
                    '最頻値' +
                    '<input type="radio" id="r1" name={{ key }} value="mode">' +
                    '中央値' +
                    '<input type="radio" id="r1" name={{ key }} value="med">' +
                    '削除' +
                    '<input type="radio" id="r1" name={{ key }} value="drop">');
             }else{
                document.write('<option value="{{ key }}">' + '{{ key }}:{{ value[0] }}' + '</option>' +
                    '平均値' +
                    '<input type="radio" id="r1" name={{ key }} value="ave">' +
                    '最頻値' +
                    '<input type="radio" id="r1" name={{ key }} value="mode">' +
                    '中央値' +
                    '<input type="radio" id="r1" name={{ key }} value="med">' +
                    '標準偏差' +
                    '<input type="radio" id="r1" name={{ key }} value="standard">' +
                    '削除' +
                    '<input type="radio" id="r1" name={{ key }} value="drop">');
             }
            
            {% endfor %}
        }
    </script>
    
    </div>

    <form action="/null_conv" method="POST" enctype="multipart/form-data">
        <option value="target">目的変数</option>
        {% for name in columns_name %}
                    {{name}}
                    <input type="radio" id="r1" name="target" value={{name}}>
                    
        {% endfor %}
        <!-- <p>欠損値の置き換え方法を選んでください</p> -->
        <script>displayRadio();</script>

        <option value="drop">削除する変数</option>
        {% for name in columns_name %}
                    {% set value = name + '_drop' %}
                    {{name}}
                    <input type="checkbox" id="r1" name={{value}} value="drop">
                    
        {% endfor %}
        <br>
        <select name="model" id = "model" onchange="radioSelect(this);">
            <option value="">モデルを選択してください</option>
            <option value="RandomForestClassifier" name = "model">RandomForestClassifier</option>
            <option value="RandomForestRegressor" name = "model">RandomForestRegressor</option>
            <!-- <option value="選択肢3" name = "name">選択肢3</option> -->
        </select>
        <label>モデルパラメータ設定
            <div id = "parameters_area">
            </div>
        </label>
    <input type="submit" value="送信">
    </form>

    <script>
        const parameters_area = document.getElementById('parameters_area');

        // name をモデルで共通にする！
        // 欠点はモデルのパラメータ名を受け取れなくなるので順番ごとにパラメータを代入する
        // name は1.2.3とかでやればモデルごとにパラメータの表示数を変えられる
        // post先でモデルの種類に応じてfor文でrequestをとれる
        var n_estimators_label = document.createTextNode("n_estimators");
        var n_estimators = document.createElement("input");
        n_estimators.setAttribute("name","1");
        n_estimators.setAttribute("type","number");
        n_estimators.setAttribute("value","100");
        n_estimators.setAttribute("max","1000");
        n_estimators.setAttribute("min","10");

        var input1 = document.createElement('input');
        input1.setAttribute("id","input1");
        input1.setAttribute("type","checkbox");
        input1.setAttribute("value","input1");
        var label1= document.createTextNode("追加項目1");

        var input2 = document.createElement('input');
        input2.setAttribute("id","input2");
        input2.setAttribute("type","checkbox");
        input2.setAttribute("value","input2");
        var label2= document.createTextNode("追加項目2");
        
        function radioSelect(model){
            
            for(let i = parameters_area.childNodes.length -1;i >= 0;i--){
                parameters_area.removeChild(parameters_area.childNodes[i]);
            }
            if(model.value == "RandomForestClassifier"){
                parameters_area.appendChild(label1);
                parameters_area.appendChild(input1);
                parameters_area.appendChild(n_estimators_label);
                parameters_area.appendChild(n_estimators);
            }else if(model.value == "RandomForestRegressor"){
                parameters_area.appendChild(label2);
                parameters_area.appendChild(input2);
            }
            
        }
        
    </script>

    

</body>
{% endblock %}